---
title: "Running multiple FACs to explore parameter variation"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


Load the package
```{r}
library(FACavian)
```


## Recreate figures in the original paper

### Figure 28.3: 3D surface

The defaults for runFAC_multi() are set to reproduce Figure 28.3 in the original Runge and Marra paper.  This is a 3D surface showing...

```{r}
F28_3 <- runFAC_multi(eq.tol = 2)
```

Look at the dataframe
```{r}
head(F28_3)
```

Plot the 3D surface.
```{r}
par(mfrow = c(1,1))
plot_Fig28_3(F28_3$multiFAC.out.df.RM)
```





### Figure 28.4

#### Create parameters

#### Create the intial range of the parameters
```{r}
F28.4.range <- param_ranges(figure = 28.4)
```

```{r}
head(F28.4.range)
```


#### Turn any varying parameters into sequence

For Figure 28.4 breding ground carrying capacity is varied.
```{r}
F28.4.seq <- param_seqs(F28.4.range)
```

```{r}
head(F28.4.seq)
```


#### Expand parameters into a grid
Create all combinations of parameters
```{r}
F28.4.grid <- param_grid(param.seqs = F28.4.seq)
```


```{r}
head(F28.4.grid)[,1:10]
```


#### Run multiple FACs accross the parameters

```{r}
F28.4.FAC <- runFAC_multi(param.grid = F28.4.grid,
                             verbose = F, eq.tol =6,
                             Ninit = c(100,0,100,0))

```




### Plot Figure 28.4

```{r}
#plot_Fig28_4(F28.4.FAC.IB$multiFAC.out.df.RM)
```







### Figure 28.5

#### Create parameters

#### Create the intial range of the parameters
```{r}
F28.5.range.winter <- param_ranges(figure = 28.5, scenario = "winter")
F28.5.range.inter  <- param_ranges(figure = 28.5, scenario = "int")
F28.5.range.summer <- param_ranges(figure = 28.5, scenario = "summer")
```

Examine the parameters
```{r}
data.frame(winter = head(F28.5.range.winter),
      int = head(F28.5.range.inter),
      summer = head(F28.5.range.summer))
```


#### Turn any varying parameters into sequence

For Figure 28.5 breding ground carrying capacity is varied.
```{r}
F28.5.win.seq <- param_seqs(F28.5.range.winter)
F28.5.int.seq <- param_seqs(F28.5.range.inter)
F28.5.sum.seq <- param_seqs(F28.5.range.summer)

```

```{r}
head(F28.5.win.seq)
```


#### Expand parameters into a grid
Create all combinations of parameters
```{r}
F28.5.win.grid <- param_grid(param.seqs = F28.5.win.seq)
F28.5.int.grid <- param_grid(param.seqs = F28.5.int.seq)
F28.5.sum.grid <- param_grid(param.seqs = F28.5.sum.seq)
```




#### Run multiple FACs accross the parameters

```{r}
F28.5.FAC.win <- runFAC_multi(param.grid = F28.5.win.grid)
F28.5.FAC.int <- runFAC_multi(param.grid = F28.5.int.grid)
F28.5.FAC.sum <- runFAC_multi(param.grid = F28.5.sum.grid)
```


### Plot Figure 28.5

```{r}
plot_Fig28_5(dat.winter.lim = F28.5.FAC.win$multiFAC.out.df.RM,
                         dat.intermediate = F28.5.FAC.int$multiFAC.out.df.RM,
                         dat.summer.lim = F28.5.FAC.sum$multiFAC.out.df.RM,
                         drain = T)

```

